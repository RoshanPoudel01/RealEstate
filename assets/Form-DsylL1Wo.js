import{u as N,e as R,c as A,m as B,R as f,r as x,n as $,o as w,j as r,h as H,F as O,P as U,S as z,i as t,H as G,B as b,t as V}from"./index-BBeA5zvM.js";import{o as L}from"./yup-BqLrT9Cd.js";import{R as T}from"./index-B17f1_I2.js";import{S as J}from"./index-6adFjG35.js";import{u as E}from"./useGetErrors-Bhs_yQR9.js";import{c as K,a as n,b as M,d as Q}from"./index.esm-DWDw-H0f.js";import"./index-CwFdvwTI.js";import"./Trash-D-gVg31T.js";const W=K().shape({name_en:n().required("Name is required"),name_np:n().required("Name is required"),description_en:n().required("Description is required"),description_np:n().required("Description is required"),image:M().required("Image is required"),display_order:Q().required("Display Order is required").typeError("Display Order must be a number"),is_active:n().required()}),te=()=>{const o={name_en:"",name_np:"",description_en:"",description_np:"",image:"",display_order:"",is_active:"1"},m=N(),{control:i,handleSubmit:y,reset:d}=R({defaultValues:o,resolver:L(W)}),{id:a}=A(),{data:e,isPending:h,isFetching:q}=B(a),[j,C]=f.useState(!1);x.useEffect(()=>{d(a?{name_en:(e==null?void 0:e.data.name_en)??"",name_np:(e==null?void 0:e.data.name_np)??"",description_en:(e==null?void 0:e.data.description_en)??"",description_np:(e==null?void 0:e.data.description_np)??"",image:e==null?void 0:e.data.image,is_active:e!=null&&e.data.is_active?"1":"0",display_order:e==null?void 0:e.data.display_order}:o)},[a,e]);const{mutateAsync:S,isPending:k,isError:c,error:u}=$(),{mutateAsync:v,isPending:D,isError:l,error:_}=w(),[s,g]=f.useState({});x.useEffect(()=>{c?g(E(u)):l&&g(E(_))},[c,u,l,_]);const P=async F=>{const p=V(F);j&&p.append("remove_image","1"),a?(await v({data:p,id:a})).data.status&&(d(o),m("/admin/category")):(await S({data:p})).data.status&&(d(o),m("/admin/category"))};return a&&(h||q)?r.jsx(H,{}):r.jsxs(O,{flexDir:"column",gap:4,children:[r.jsx(U,{heading:a?"Edit Category":"Add Category",description:a?"Edit the category details":"Add the category details"}),r.jsx(z,{alignItems:"start",columns:{base:1,md:2},gap:4,asChild:!0,children:r.jsxs("form",{onSubmit:y(P),noValidate:!0,id:"category-form",children:[r.jsx(t,{control:i,required:!0,backendError:s.name_en,name:"name_en",label:"Name (En)"}),r.jsx(t,{control:i,required:!0,name:"name_np",label:"Name (Np)",backendError:s.name_np}),r.jsx(t,{control:i,required:!0,name:"description_en",label:"Description (En)",type:"textarea",backendError:s.description_en}),r.jsx(t,{control:i,required:!0,name:"description_np",label:"Description (Np)",type:"textarea",backendError:s.description_np}),r.jsx(t,{control:i,required:!0,name:"display_order",label:"Display Order",backendError:s.display_order,type:"number"}),r.jsx(J,{control:i,name:"is_active",label:"Status"}),r.jsx(T,{name:"image",control:i,required:!0,backendError:s.image,label:"Image",file:(e==null?void 0:e.data.image)??"",setRemoveImage:C,options:{accept:{"image/*":[]},maxSize:5},message:"Drop image here or click to upload"})]})}),r.jsxs(G,{mt:4,children:[r.jsx(b,{variant:"outline",colorPalette:"gray",onClick:()=>m(-1),children:"Back"}),r.jsx(b,{type:"submit",form:"category-form",colorPalette:"primary",color:"white",loading:k||D,children:"Submit"})]})]})};export{te as default};
