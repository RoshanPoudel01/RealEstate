import{u as A,b as B,a as $,R as f,r as b,j as r,c as w,F as G,P as H,S as O,d as s,H as U,B as x,t as z}from"./index-CLXe-kly.js";import{o as V}from"./yup-CXomuO52.js";import{R as L}from"./index-DMkinjFe.js";import{S as T}from"./index-DQEohzPk.js";import{u as J}from"./useGetDirtyData-Dc4_-Xhu.js";import{u as E}from"./useGetErrors-Bhs_yQR9.js";import{b as K,c as M,d as Q}from"./service-category-BDvSVdfZ.js";import{c as W,a as n,b as X,d as Y}from"./index.esm-BBqtjLFR.js";import"./index-mcGzOTzL.js";import"./Trash-BOd_nab5.js";const Z=W().shape({name_en:n().required("Name is required"),name_np:n().required("Name is required"),description_en:n().required("Description is required"),description_np:n().required("Description is required"),image:X().required("Image is required"),display_order:Y().required("Display Order is required").typeError("Display Order must be a number"),is_active:n().required()}),pe=()=>{const o={name_en:"",name_np:"",description_en:"",description_np:"",image:"",display_order:"",is_active:"1"},m=A(),{control:t,handleSubmit:y,reset:d,formState:q}=B({defaultValues:o,resolver:V(Z)}),{id:a}=$(),{data:e,isPending:h,isFetching:j}=K(a),[D,S]=f.useState(!1);b.useEffect(()=>{d(a?{name_en:(e==null?void 0:e.data.name_en)??"",name_np:(e==null?void 0:e.data.name_np)??"",description_en:(e==null?void 0:e.data.description_en)??"",description_np:(e==null?void 0:e.data.description_np)??"",image:e==null?void 0:e.data.image,is_active:e!=null&&e.data.is_active?"1":"0",display_order:e==null?void 0:e.data.display_order}:o)},[a,e]);const{mutateAsync:C,isPending:k,isError:c,error:u}=M(),{mutateAsync:v,isPending:F,isError:l,error:_}=Q(),[i,g]=f.useState({});b.useEffect(()=>{c?g(E(u)):l&&g(E(_))},[c,u,l,_]);const P=async I=>{const N=J(q,I),p=z(N);D&&p.append("remove_image","1"),a?(await v({data:p,id:a})).data.status&&(d(o),m("/admin/category")):(await C({data:p})).data.status&&(d(o),m("/admin/category"))};return a&&(h||j)?r.jsx(w,{}):r.jsxs(G,{flexDir:"column",gap:4,children:[r.jsx(H,{heading:a?"Edit Category":"Add Category",description:a?"Edit the category details":"Add the category details"}),r.jsx(O,{alignItems:"start",columns:{base:1,md:2},gap:4,asChild:!0,children:r.jsxs("form",{onSubmit:y(P),noValidate:!0,id:"category-form",children:[r.jsx(s,{control:t,required:!0,backendError:i.name_en,name:"name_en",label:"Name (En)"}),r.jsx(s,{control:t,required:!0,name:"name_np",label:"Name (Np)",backendError:i.name_np}),r.jsx(s,{control:t,required:!0,name:"description_en",label:"Description (En)",type:"textarea",backendError:i.description_en}),r.jsx(s,{control:t,required:!0,name:"description_np",label:"Description (Np)",type:"textarea",backendError:i.description_np}),r.jsx(s,{control:t,required:!0,name:"display_order",label:"Display Order",backendError:i.display_order,type:"number"}),r.jsx(T,{control:t,name:"is_active",label:"Status"}),r.jsx(L,{name:"image",control:t,required:!0,backendError:i.image,label:"Image",file:(e==null?void 0:e.data.image)??"",setRemoveImage:S,options:{accept:{"image/*":[]},maxSize:5},message:"Drop image here or click to upload"})]})}),r.jsxs(U,{mt:4,children:[r.jsx(x,{variant:"outline",colorPalette:"gray",onClick:()=>m(-1),children:"Back"}),r.jsx(x,{type:"submit",form:"category-form",colorPalette:"primary",color:"white",loading:k||F,children:"Submit"})]})]})};export{pe as default};
